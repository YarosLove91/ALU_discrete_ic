# Virtual_FPGA_BOARDS

# Виртуальная плата DE2-115 

![Скриншот эмулятора](images/screenshot.jpg)

## Описание проекта

Эмулятор платы DE2-115 с полным функционалом, включая:
- Графический интерфейс пользователя
- Сетевое взаимодействие с Verilog-симуляцией
- 18 переключателей
- 18 красных светодиодов
- 8 зеленых светодиодов
- 8 семисегментных индикаторов
- 4 кнопки
- Сохранение и загрузка состояний

## Основные возможности

- Точная эмуляция компонентов платы DE2-115
- Интерактивное взаимодействие с Verilog-симуляцией
- Адаптивный интерфейс с масштабированием
- Гибкая система конфигурации
- Сохранение положений переключателей и кнопок между сеансами
- Сброс состояния к значениям по умолчанию

## Требования

### Для графического клиента

- Python 3.6+
- Библиотеки:
  - `tkinter`
  - `Pillow` (PIL)
  - `json`
  - `configparser`

### Для сервера

- Verilator 4.0+
- Компилятор с поддержкой C++17
- Библиотеки:
  - `libjsoncpp`
  - `pthread`

## Установка

1. Клонируйте репозиторий:
```bash
git clone -b stand_ALU_16b https://git.miem.hse.ru/1963/virtual_fpga_boards.git
cd virtual_fpga_boards
```

2. Установите зависимости Python:
```bash
pip install pillow
```

3. Соберите сервер:
```bash
make build
```

## Использование

Возможен одновременный запуск через Makefile или запуск графического клиента и сервера по отдельности.
Во втором случае при запуске графического клиента можно ввести параметры расширения окна.

# Запуск через Makefile

```bash
make run
```

# Запуск графического клиента

```bash
python app.py [--width ШИРИНА] [--height ВЫСОТА] [--config ФАЙЛ]
```

Параметры:

--width: Ширина окна в пикселях (переопределяет конфиг)

--height: Высота окна в пикселях (переопределяет конфиг)

--config: Путь к файлу конфигурации (по умолчанию: config.ini)

# Файл конфигурации

Отредактируйте config.ini для настройки размеров окна:

```ini
[DEFAULT]
width = 800
height = 500
```

# Запуск сервера

```bash
./server
```

## Функционал графического интерфейса

- **Переключатели**: 18 переключателей, которые можно включать и выключать. Их состояние сохраняется между сеансами.
- **Кнопки**: 4 кнопки, которые остаются "нажатыми" после клика и возвращаются в исходное состояние при повторном клике.
- **Красные светодиоды**: 18 светодиодов, отображающих состояние.
- **Зеленые светодиоды**: 8 светодиодов, отображающих режимы работы.
- **Семисегментные индикаторы**: 8 индикаторов, отображающих значения.
- **Кнопка "Save"**: Сохраняет текущее состояние переключателей и кнопок в файл state.pkl.
- **Кнопка "Load"**: Загружает сохраненное состояние из файла state.pkl.
- **Кнопка "Reset"**: Сбрасывает состояние переключателей и кнопок к значениям по умолчанию.

## Makefile

Доступные команды:

| Команда          | Описание                                                                 |
|------------------|--------------------------------------------------------------------------|
| `make`           | Показывает справку по доступным командам                                |
| `make build`     | Собирает проект (верилирует Verilog и компилирует C++ код)              |
| `make run`       | Собирает и запускает сервер                                             |
| `make clean`     | Удаляет все сгенерированные файлы сборки                                |
| `make check_python` | Проверяет версию Python (должна быть 3.6+)                          |

## Таблица сигналов

На виртуальной плате DE2-115 загружено 16-битное АЛУ, которое поддерживает арифметические и логические операции. Ниже приведено описание сигналов, подключенных к элементам платы.

| **Сигнал**         | **Описание**                              | **Подключение**                     |
|---------------------|------------------------------------------|--------------------------------------|
| `alu_result[15:0]` | Результат работы АЛУ                     | LEDR0-LEDR15, HEX0-HEX3 |
| `alu_cout`         | Перенос (Carry Out)                      | LEDG0               |
| `a_reg[15:0]`      | Регистр операнда A                      | SW7-SW0 и KEY0 (запись), KEY1 (сброс) |
| `b_reg[15:0]`      | Регистр операнда B                      | SW7-SW0 и KEY0 (запись), KEY2 (сброс) |
| `sel[3:0]`         | Код операции АЛУ                        | SW14-SW11         |
| `mode`             | Режим работы АЛУ (арифметический/логический) | SW15           |
| `carry_in`         | Входной перенос (Carry In)               | SW8               |
| `SW[9]`              | Выбор операнда (A или B)                 | SW9                                 |
| `SW[10]`      | Выбор части операнда (младшая/старшая)    | SW10                                |
| `KEY[0]`            | Запись данных в регистр                 | KEY0                                |
| `KEY[1]`          | Сброс регистра A                        | KEY1                                |
| `KEY[2]`          | Сброс регистра B                        | KEY2         