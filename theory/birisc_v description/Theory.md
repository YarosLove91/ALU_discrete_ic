# Лабораторная работа "Исследование программного процессора biRISC-V"

## Цель работы
Ознакомление с архитектурой 32-битного RISC-процессора biRISC-V, изучение его системы команд и приобретение практических навыков программирования на ассемблере RISC-V.

## 1. Описание процессора biRISC-V

### 1.1 ключевые особенности процессора biRISC-V
biRISC-V - это 32-битный суперскалярный RISC-V процессор со следующими характеристиками:

- 32-разрядное процессорное ядро RISC-V ISA.
- Суперскалярный (с двумя АЛУ) 6- или 7-ступенчатый конвейер.
- Поддержка целочисленных инструкций RISC-V (I), умножения и деления (M), а также расширения инструкций CSR (Z) (RV32IMZicsr).
- Предсказание ветвлений (bimodel/gshare) с настраиваемой глубиной целевого буфера ветвлений (BTB) и стека адреса возврата (RAS).
- 64-битная выборка инструкций, 32-битный доступ к данным.
- 2 x целочисленных ALU (операции: арифметические, сдвига и ветвления).
- 1 x блок хранения с загрузкой, 1 x внеконвейерный делитель.
- Выдача и выполнение до 2 независимых инструкций за цикл.
- Поддерживаются уровни привилегий пользователя, супервизора и машинного режима.
- Базовая поддержка модуля управления памятью (Memory Manage Unit - MMU) - возможность загрузки Linux с эмуляцией атомарных инструкции (RV-A).
- Реализованы базовая спецификация ISA v2.1 и привилегированная спецификация ISA v1.11.
- Верифицированный дизайн с помощью случайных последовательностей инструкций RISCV-DV от Google, используя косимуляцию с моделью ISA C++.
- Поддержка кэша инструкций/данных, интерфейсов шины AXI или тесно связанной памяти (TCM - памяти).
- Настраиваемое количество стадий конвейера, опции пересылки результатов и ресурсы предсказания ветвлений.
- Синтезируемый Verilog 2001, совместимый с Verilator и FPGA.
- Производительность: Coremark: 4.1 CoreMark/МГц и Dhrystone: 1.9 DMIPS/MHz («законные варианты компиляции» / 337 инструкций на итерацию).

### 1.2 Реализация процессора

Процессор biRISC-V реализован в двух вариантах: c использованием тесно связанной (Tightly Coupled Memory, TCM) памятью с фиксированным временем доступа и с использованием ОЗУ, кеша данных и инструкции.  
Дизайны имеют общие модули описание которых представлено в разделе "Общие модули". Описание архитектуры процессора с TCM памятью представлено в разделе ..., описание архитектуры процессора с памятью представлено в разделе ...

riscv_core c подмодулями: issue, frontend, exec, multiplier, csr, lsu, mmu, divider, icache.  

### 1.2.1 Общие модули RLT-дизайнов процессора.

```
riscv_core
├── issue
│ ├── trace_sim
│ ├── regfile
│ └── pipe_ctrl
├── frontend
│ ├── npc
│ ├── fetch
│ └── decode
├── icache
│ ├── data_ram
│ └── reg_ram
├── exec
├── multiplier
├── csr
├── lsu
├── mmu
├── divider
└ [Различающиеся модули]

```

__Функциональное назначение модулей в дизайне с TCM памятью:__

__Основное функциональное назначение:__ 


#### 1.2.2 Реализация процессора с использованием TCM памяти

Тесно связанная память (Tightly Coupled Memory, TCM) является частью адресуемой памяти, физически расположенной на первом уровне иерархии памяти, в непосредственной близости к кэш-памяти первого уровня.

Архитектура RTL-процессора имеет следующую иерархическую структуру:

```
[Модули общие для обоих дизайнов]
├── dport_mux
├── dport_axi
└── tcm_mem
  ├── tcm_mem_ram
  └── tcm_mem_pmem

```


__Функциональное назначение модулей в дизайне с TCM памятью:__
__Основное функциональное назначение:__ 

![](../birisc_v%20description/Images/riscv_tcm_top.png)

#### 1.2.3 Реализация процессора с использованием ОЗУ

Архитектура RTL-процессора имеет следующую иерархическую структуру:

[Модули общие для обоих дизайнов]
├── dcache
├── dcache_core
│ ├── dcache_core_data_ram
│ └── dcache_core_tag_ram
├── dcache_axi
│ ├── dcache_axi_fifo
│ └── dcache_axi_axi
├── dcache_mux
├── dcache_ifpem_mux
└── dcache_ifpem


Структурная схема дизайна с использованием кешей представлена на изображении xxx


![](../birisc_v%20description/Images/riscv_top.png)